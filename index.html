<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SR Diagnostics Immobiliers</title>
  <meta name="description" content="Diagnostics immobiliers pour vente & location : DPE, amiante, plomb, √©lectricit√©, gaz, ERP, termites." />
  <style>
    :root{--blue:#1c7df0;--ink:#0f2744;--bg:#f4f8ff;--card:#fff;--border:#d4e3fb}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;line-height:1.55;background:var(--bg);color:var(--ink)}
    header,main,footer{max-width:980px;margin:auto;padding:18px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:18px;margin:12px 0}
    nav{display:flex;gap:10px;flex-wrap:wrap}
    nav a{padding:8px 12px;border-radius:10px;background:#e8f1ff;text-decoration:none;color:#1565c0}
    .grid,.form-grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    input,textarea,select{width:100%;padding:10px;border-radius:10px;border:1px solid #b9d1f3}
    button{padding:12px 14px;border-radius:10px;border:0;background:var(--blue);color:#fff;font-weight:700;cursor:pointer}
    .secondary{background:#0f2744}
    .hidden{display:none}.result{margin-top:14px;padding:14px;border-radius:12px;background:#eff6ff;border:1px solid #b7d2fb}
    .pill{display:inline-block;padding:6px 10px;border-radius:999px;background:#eaf2ff;border:1px solid #cfe2ff}
  </style>
</head>
<body>
  <header>
    <h1>SR Diagnostics Immobiliers</h1>
    <p>Diagnostics immobiliers pour vente & location ‚Äî DPE, amiante, plomb, √©lectricit√©, gaz, ERP, termites.</p>
    <p>
      <span class="pill">üìû <a href="tel:+33767076761">07 67 07 67 61</a></span>
      <span class="pill">‚úâÔ∏è <a href="mailto:stephanr.pro@gmail.com">stephanr.pro@gmail.com</a></span>
      <span class="pill">üïí Lun‚ÄìDim 8h‚Äì20h</span>
    </p>
    <nav>
      <a href="index.html">Accueil & devis</a>
      <a href="actualites.html">Actualit√©s</a>
      <a href="#contact">Contact</a>
    </nav>
  </header>

  <main>
    <div class="grid">
      <div class="card">
        <h2>Prestations</h2>
        <ul>
          <li>DPE</li><li>Amiante</li><li>Plomb (CREP)</li><li>√âlectricit√©</li><li>Gaz</li><li>ERP</li><li>Termites</li>
        </ul>
      </div>
      <div class="card">
        <h2>Zone d‚Äôintervention</h2>
        <p>Arras ‚Ä¢ Lens ‚Ä¢ H√©nin ‚Ä¢ Beaumont ‚Ä¢ Douai ‚Ä¢ B√©thune</p>
      </div>
    </div>

    <div class="card">
      <h2>Devis en ligne</h2>
      <form name="devis" method="POST" action="/merci.html" data-netlify="true" netlify-honeypot="bot-field" id="devis-form">
        <input type="hidden" name="form-name" value="devis" />
        <p class="hidden"><label>Ne pas remplir ce champ: <input name="bot-field" /></label></p>
        <input type="hidden" name="diagnostics_a_prevoir" id="diagnostics-a-prevoir" />
        <input type="hidden" name="sur_devis" id="sur-devis" value="non" />

        <div class="form-grid">
          <div><label>Nom<input id="nom" name="nom" required /></label></div>
          <div><label>Email<input id="email" name="email" type="email" required /></label></div>
          <div><label>T√©l√©phone<input id="telephone" name="telephone" /></label></div>
          <div><label>Ann√©e de construction<input id="annee-construction" name="annee_construction" type="number" min="1600" max="2100" required /></label></div>
          <div><label>Surface (m¬≤)<input id="surface" name="surface" type="number" min="1" required /></label></div>
          <div><label>Installation de gaz fixe
            <select id="has-gaz" name="installation_gaz_fixe" required><option value="">S√©lectionner</option><option value="oui">Oui</option><option value="non">Non</option></select>
          </label></div>
          <div><label>Installation √©lectrique
            <select id="has-elec" name="installation_electrique" required><option value="">S√©lectionner</option><option value="oui">Oui</option><option value="non">Non</option></select>
          </label></div>
          <div><label>DPE d√©j√† valide
            <select id="dpe-deja" name="dpe_deja_valide" required><option value="">S√©lectionner</option><option value="oui">Oui</option><option value="non">Non</option></select>
          </label></div>
        </div>

        <p><a href="https://termite.com.fr/rechercher/" target="_blank" rel="noopener">V√©rifier termite.com.fr</a>
        <label><input type="checkbox" id="termite-zone" name="zone_termites_selon_verif" /> Zone termites</label></p>

        <p><button type="button" id="calculer-devis">Calculer</button> <button class="secondary" type="submit">Envoyer la demande</button></p>
        <div class="result" id="resultat-devis" hidden></div>
        <label>Message compl√©mentaire<textarea id="message" name="message" rows="5"></textarea></label>
      </form>
    </div>

    <div class="card" id="contact">
      <h2>Contact</h2>
      <p><strong>T√©l :</strong> <a href="tel:+33767076761">07 67 07 67 61</a></p>
      <p><strong>Email :</strong> <a href="mailto:stephanr.pro@gmail.com">stephanr.pro@gmail.com</a></p>
    </div>
  </main>

  <footer>¬© SR Diagnostics Immobiliers</footer>

  <script>
    document.addEventListener('DOMContentLoaded', function(){
      const mapLabels = { dpe:'DPE', amiante:'Amiante', plomb:'Plomb (CREP)', gaz:'Gaz', electricite:'√âlectricit√©', erp:'ERP', termites:'√âtat parasitaire (termites)' };
      const val = (id) => (document.getElementById(id)?.value || '').trim();
      const checked = (id) => !!document.getElementById(id)?.checked;

      function getDiagnosticsRecommandes() {
        const year = Number(val('annee-construction'));
        const surface = Number(val('surface'));
        const hasGaz = val('has-gaz') === 'oui';
        const hasElec = val('has-elec') === 'oui';
        const dpeDeja = val('dpe-deja') === 'oui';
        const termitesZone = checked('termite-zone');
        const billed = new Set(['erp']);
        if (!dpeDeja) billed.add('dpe');
        if (year && year < 1949) billed.add('plomb');
        if (year && year < 1997) billed.add('amiante');
        if (hasGaz) billed.add('gaz');
        if (hasElec) billed.add('electricite');
        if (termitesZone) billed.add('termites');
        const list = [...billed];
        const surDevis = (surface && surface > 200) || list.length === 0 || list.length > 6;
        return { list, surDevis, surface };
      }

      function computeAndRender() {
        const result = document.getElementById('resultat-devis');
        const hiddenDiag = document.getElementById('diagnostics-a-prevoir');
        const hiddenSurDevis = document.getElementById('sur-devis');
        const message = document.getElementById('message');
        const { list, surDevis, surface } = getDiagnosticsRecommandes();
        hiddenDiag.value = list.map(d => mapLabels[d]).join(', ') || 'Aucun';
        hiddenSurDevis.value = surDevis ? 'oui' : 'non';
        result.innerHTML = '<p><strong>Diagnostics :</strong> ' + hiddenDiag.value + '</p><p><strong>Surface :</strong> ' + (Number.isFinite(surface) ? surface + ' m¬≤' : '‚Äî') + '</p><p><strong>Statut :</strong> ' + (surDevis ? 'Sur devis' : 'Pack calculable') + '</p>';
        result.hidden = false;
        const resume = 'Pr√©-s√©lection automatique:\n- Diagnostics : ' + hiddenDiag.value + '\n- Sur devis : ' + hiddenSurDevis.value + '\n';
        message.value = message.value.replace(/\n?Pr√©-s√©lection automatique:[\s\S]*$/m, '').trim();
        message.value = (message.value + '\n\n' + resume).trim();
      }

      document.getElementById('calculer-devis')?.addEventListener('click', computeAndRender);
      document.getElementById('devis-form')?.addEventListener('submit', computeAndRender);
    });
  </script>
</body>
</html>
